clear all;close all;%kKey  = KBName('k'); OneKey   = KBName('1'); TwoKey   = KBName('2'); ThreeKey = KBName('3'); FourKey  = KBName('4'); FiveKey  = KBName('5'); SixKey = KBName('6'); SevenKey  = KBName('7'); EightKey  = KBName('8'); NineKey  = KBName('9');if strcmp(computer, 'PCWIN')    error('Win: the Showtime extension is not yet provided'); endclear Showtime;dog = dir('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:movies');temp = size(dog);filenumber = temp(1)cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:movies');% % windowwindow0=Screen(0,'OpenWindow');white=WhiteIndex(window0);black=BlackIndex(window0);Screen(window0,'FillRect',black);Screen(window0,'TextFont','Helvetica');Screen(window0,'TextSize',24);Screen(window0,'DrawText','Please wait a moment for the movies to load',200,300,white);for i=1:filenumber	filename = dog(i).name;	movie(i)=Showtime('GetFromFile',filename);	Showtime('LoadIntoRam',movie(i));endScreen(window0,'FillRect',black);Screen(window0,'TextFont','Helvetica');Screen(window0,'TextSize',24);Screen(window0,'DrawText','Loading completed. Please read instructions',200,200,white);Screen(window0,'DrawText','You are about to see a series of animated movements. In each',200,400,white);Screen(window0,'DrawText','display, you will see a movie of a character performing a knocking',200,450,white);Screen(window0,'DrawText','action.  Your task is to report how acceptable you find the character to',200,500,white);Screen(window0,'DrawText','relate to on a scale of 1-9, with 1 indicating you find it totally unacceptable and',200,550,white);Screen(window0,'DrawText','9 indicating you find it totally acceptable.',200,600,white);Screen(window0,'DrawText','You indicate your judgement by pressing the number keys.',200,650,white);Screen(window0,'DrawText','Please use the whole range of numbers from 1-9. Thank you.',200,700,white);Screen(window0,'DrawText','Click the mouse to start the experiment.',200,750,white);GetClicks;Screen(window0,'FillRect',black);SubjectName = GetEchoString(window0,'Please enter your first name, omitting any spaces:',100,100,white,black);Screen(window0,'Close');for kjm=1:1			Rand_Num=RandPerm(filenumber);		Rate_List=zeros(filenumber,1);	Time_List=zeros(filenumber,1);	for i=1:filenumber		Rate_Matrix(i)=-1;	end	whichScreen=0;	window=Showtime('OpenWindow',whichScreen,[255]);	for i=1:filenumber		Screen(window,'FillRect',black);		start_time = GetSecs;		Showtime('Window',movie(Rand_Num(i)),window);		Showtime('Show',movie(Rand_Num(i)));		Screen(window,'FillRect',black);				Screen(window,'TextFont','Helvetica');		Screen(window,'TextSize',24);		Screen(window,'DrawText','Please decide on a scale of 1-9 how acceptable you find the displayed character to relate to.',300,350,white);		Screen(window,'DrawText','1 is totally unacceptable',300,400,white);		Screen(window,'DrawText','9 is totally acceptable',300,450,white);				% get repsonse		while 1			[KeyIsDown, keysecs, KeyCode] = KbCheck;			if KeyIsDown				FlushEvents('keyDown');								if KeyCode(OneKey)==1					rating_value = '1';					break;				end							if KeyCode(TwoKey)==1					rating_value = '2';					break;				end							if KeyCode(ThreeKey)==1					rating_value = '3';					break;				end							if KeyCode(FourKey)==1					rating_value = '4';					break;				end							if KeyCode(FiveKey)==1					rating_value = '5';					break;				end							if KeyCode(SixKey)==1					rating_value = '6';					break;				end							if KeyCode(SevenKey)==1					rating_value = '7';					break;				end							if KeyCode(EightKey)==1					rating_value = '8';					break;				end							if KeyCode(NineKey)==1					rating_value = '9';					break;				end																		end %KeyIsDown		end %while 1			Rate_List(Rand_Num(i))=rating_value;				Screen(window,'FillRect',black);		time_gap = GetSecs - start_time;		Time_List(Rand_Num(i))=time_gap;	end	Showtime('CloseWindow',window);				%%% Write data into a file		cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:');	cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:data');		DataFileName = strcat(SubjectName,'blk',num2str(kjm),'.txt');	DataFp = fopen(DataFileName,'w');	fprintf(DataFp,'This is a experiment data file designed by Ma YingLiang\n');	fprintf(DataFp,Date);	fprintf(DataFp,'\n');		fprintf(DataFp,'Trial MovIndex  Rating  Time\n');	for i=1:filenumber		fprintf(DataFp,'%d  ',i);		fprintf(DataFp,'%s  ',dog(Rand_Num(i)).name);		fprintf(DataFp,'%s  ',Rate_List(Rand_Num(i)));		fprintf(DataFp,'%f ',Time_List(Rand_Num(i)));		fprintf(DataFp,'\n');	end		fclose(DataFp);		cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:');		end %kjmfor i=1:filenumber	Showtime('Dispose',movie(i));endcd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:static');Rand_Num=RandPerm(7);	Rate_List=zeros(7,1);	for i=1:7		Rate_List(i)=-1;	endwindow0=Screen(0,'OpenWindow');white=WhiteIndex(window0);black=BlackIndex(window0);xsize = 400;ysize = 300;xoffset = 440;yoffset = 300;presRect = [xoffset yoffset xoffset+xsize-1 yoffset+ysize-1];ScreenNumber = 0;PixelSizes = SCREEN(ScreenNumber,'PixelSizes');pixeldepth = max(PixelSizes);pixeldepth = 32;	whichScreen=0;	window=Showtime('OpenWindow',whichScreen,[255]);	load lowma	images = [{'klank'};{'himan'};{'battle'};{'zombie'};{'skeleton'};{'manny'};{'lowman'}]		tempscreen2 = SCREEN(window,'OpenOffscreenWindow',black,[],pixeldepth);	for i=1:7		Screen(window,'FillRect',black);		Screen(window,'TextFont','Helvetica');		Screen(window,'TextSize',24);		Screen(window,'DrawText','Please decide on a scale of 1-9 how acceptable you find the displayed character to relate to.',300,700,white);		Screen(window,'DrawText','1 is totally unacceptable',600,750,white);		Screen(window,'DrawText','9 is totally acceptable',600,800,white);					static = images(Rand_Num(i));		static = char(static);				Screen(tempscreen2,'PutImage',eval(static),presRect);						Screen(window,'WaitBlanking');		Screen('CopyWindow',tempscreen2,window,presRect,presRect,'srcCopyQuickly');				% get repsonse		while 1			[KeyIsDown, keysecs, KeyCode] = KbCheck;			if KeyIsDown				FlushEvents('keyDown');								if KeyCode(OneKey)==1					rating_value = '1';					break;				end							if KeyCode(TwoKey)==1					rating_value = '2';					break;				end							if KeyCode(ThreeKey)==1					rating_value = '3';					break;				end							if KeyCode(FourKey)==1					rating_value = '4';					break;				end							if KeyCode(FiveKey)==1					rating_value = '5';					break;				end							if KeyCode(SixKey)==1					rating_value = '6';					break;				end							if KeyCode(SevenKey)==1					rating_value = '7';					break;				end							if KeyCode(EightKey)==1					rating_value = '8';					break;				end							if KeyCode(NineKey)==1					rating_value = '9';					break;				end																		end %KeyIsDown		end %while 1			%Rate_List(Rand_Num(i))=rating_value;		Rate_List(i)=rating_value;				Screen(window,'FillRect',black);	% 	Showtime('CloseWindow',window)% 		cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:');% 	cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:data');		DataFileName = strcat(SubjectName,'_static','.txt');	DataFp = fopen(DataFileName,'w');	fprintf(DataFp,'This is a experiment data file designed by Ma YingLiang\n');	fprintf(DataFp,Date);	fprintf(DataFp,'\n');		fprintf(DataFp,'MovIndex  Rating\n');	for i=1:7		fprintf(DataFp,'%s  ',char(images(Rand_Num(i))));		%fprintf(DataFp,'%s  ',Rate_List(Rand_Num(i)));		fprintf(DataFp,'%s  ',Rate_List(i));		fprintf(DataFp,'\n');	end  	fclose(DataFp); 	 	cd('Macintosh HD:Users:Shared:gavin:blending_knock_lift_forlawrie:data:');	endScreen('CloseALL');clear all