---
title: "Data processing"
author: "Sean Hughes"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  html_document:
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc: yes 
    toc_float: yes
---


```{r include=FALSE}
knitr::opts_chunk$set(message=FALSE,
                      warning=FALSE)
```


# Functions and dependencies

```{r}

library(tidyverse)
library(knitr)
library(kableExtra)
library(tidyverse)

```

# Get raw data

```{r}

data_preprocessed <- read_rds("processed/1_data_preprocessed.rds")

```


## Study conditions, demographics and method variables

# Trial-level data (Likeness Condition) 

Bring data into 'tidy' format, drop rows and columns that aren't used to score the tasks, etc.

NB no attempt to remove duplicate participants is made at this stage - that is done below in the participant level data where exclusions are made based on completeness.

```{r}

data_trial_level_likeness_condition <- data_preprocessed %>%
    filter(experiment_condition == "Human Likeness Condition") %>%
  
  mutate(revised_exp_condition = case_when(grepl("1.", condition) ~ "1. Human_Likeness_First_Static", grepl("2.", condition) ~ "2. Acceptability_First_Static")) %>%
  
  mutate(condition_number = case_when(grepl("1.", condition) ~ 1, grepl("2.", condition) ~ 2)) %>%

  mutate(ratings_type = case_when(grepl("Acceptability", revised_exp_condition) ~ "Acceptability First / Human Likeness Second", grepl("Likeness", revised_exp_condition) ~ "Human Likeness First / Acceptability Second")) %>% 

  mutate(content_type = case_when(grepl("Static", revised_exp_condition) ~ "Static Images")) %>% 
  
  rename(task = sender) %>%
  mutate(task = tolower(task)) %>% 
         
  # propagate exp condition up and down rows within each participant
  group_by(subject) %>%
  fill(matches("condition_alt"), .direction = "down") %>%
  fill(matches("condition_alt"), .direction = "up") %>%
  ungroup() %>%

    mutate(experiment_condition = ifelse(is.na(experiment_condition), experiment_condition_alt, experiment_condition)) %>%

    filter(task %in% c("demographics",
                       "acceptability_battle_robot",
                       "acceptability_high_man",
                       "acceptability_lo_man",
                       "acceptability_mannequin",
                       "acceptability_skeleton",
                       "acceptability_toy_robot",
                       "acceptability_zombie", 
                       "likeness_battle_robot",
                       "likeness_high_man",
                       "likeness_lo_man",
                       "likeness_mannequin",
                       "likeness_skeleton",
                       "likeness_toy_robot",
                       "likeness_zombie", 
                       "exploratory_questions",
                       "issues")) %>%
    
  # retain only rows with useful information used to score the tasks
  select(subject,
         experiment,
         experiment_condition,
         condition,
         condition_number,
         ratings_type,
         content_type,
         task,
         age,
         gender,
         gender_self_describe,
         acceptability_rating,
         likeness_rating,
         uncanny_valley_check_1,
         uncanny_valley_check_2) %>%
  
  # guess appropriate data types
  type_convert()  


```


# Trial-level data (Acceptability Condition) 

Bring data into 'tidy' format, drop rows and columns that aren't used to score the tasks, etc.

NB no attempt to remove duplicate participants is made at this stage - that is done below in the participant level data where exclusions are made based on completeness.

```{r}

data_trial_level_acceptability_condition <- data_preprocessed %>%
    filter(experiment_condition == "Acceptability Condition") %>%
  
   mutate(revised_exp_condition = case_when(grepl("1.", condition) ~ "1. Acceptability_Images_1st_Videos_2nd", grepl("2.", condition) ~ "2. Acceptability_Videos_1st_Images_2nd")) %>%
  
  mutate(condition_number = case_when(grepl("1. Acceptability_Images_1st_Videos_2nd", condition) ~ 1, grepl("2. Acceptability_Videos_1st_Images_2nd", condition) ~ 2)) %>%

  mutate(ratings_type = case_when(grepl("Acceptability", revised_exp_condition) ~ "Acceptability Only")) %>% 

  mutate(content_type = case_when(grepl("Acceptability", revised_exp_condition) ~ "Static Images and Videos")) %>%

  rename(task = sender) %>%
  mutate(task = tolower(task)) %>% 
         
  # propagate exp condition up and down rows within each participant
  group_by(subject) %>%
  fill(matches("condition_alt"), .direction = "down") %>%
  fill(matches("condition_alt"), .direction = "up") %>%
  ungroup() %>%

    mutate(experiment_condition = ifelse(is.na(experiment_condition), experiment_condition_alt, experiment_condition)) %>%

    filter(task %in% c("demographics",
                       
                       "acceptability_battle_robot_static_b1",
                       "acceptability_high_man_static_b1",
                       "acceptability_lo_man_static_b1",
                       "acceptability_mannequin_static_b1",
                       "acceptability_skeleton_static_b1",
                       "acceptability_toy_robot_static_b1",
                       "acceptability_zombie_static_b1",
                       "acceptability_battle_robot_static_b2",
                       "acceptability_high_man_static_b2",
                       "acceptability_lo_man_static_b2",
                       "acceptability_mannequin_static_b2",
                       "acceptability_skeleton_static_b2",
                       "acceptability_toy_robot_static_b2",
                       "acceptability_zombie_static_b2",
                       "acceptability_battle_robot_static_b3",
                       "acceptability_high_man_static_b3",
                       "acceptability_lo_man_static_b3",
                       "acceptability_mannequin_static_b3",
                       "acceptability_skeleton_static_b3",
                       "acceptability_toy_robot_static_b3",
                       "acceptability_zombie_static_b3",
                       
                       "acceptability_battle_robot_m1_v1",
                       "acceptability_battle_robot_m1_v2",
                       "acceptability_battle_robot_m1_v3",
                       "acceptability_battle_robot_m1_v4",
                       "acceptability_battle_robot_m1_v5",
                       "acceptability_battle_robot_m1_v6",
                       "acceptability_battle_robot_m2_v1",
                       "acceptability_battle_robot_m2_v2",
                       "acceptability_battle_robot_m2_v3",
                       "acceptability_battle_robot_m2_v4",
                       "acceptability_battle_robot_m2_v5",
                       "acceptability_battle_robot_m2_v6",
                       "acceptability_battle_robot_m3_v1",
                       "acceptability_battle_robot_m3_v2",
                       "acceptability_battle_robot_m3_v3",
                       "acceptability_battle_robot_m3_v4",
                       "acceptability_battle_robot_m3_v5",
                       "acceptability_battle_robot_m3_v6",
                       "acceptability_battle_robot_m4_v1",
                       "acceptability_battle_robot_m4_v2",
                       "acceptability_battle_robot_m4_v3",
                       "acceptability_battle_robot_m4_v4",
                       "acceptability_battle_robot_m4_v5",
                       "acceptability_battle_robot_m4_v6",
                       "acceptability_battle_robot_m5_v1",
                       "acceptability_battle_robot_m5_v2",
                       "acceptability_battle_robot_m5_v3",
                       "acceptability_battle_robot_m5_v4",
                       "acceptability_battle_robot_m5_v5",
                       "acceptability_battle_robot_m5_v6",
                       
                       "acceptability_high_man_m1_v1",
                       "acceptability_high_man_m1_v2",
                       "acceptability_high_man_m1_v3",
                       "acceptability_high_man_m1_v4",
                       "acceptability_high_man_m1_v5",
                       "acceptability_high_man_m1_v6",
                       "acceptability_high_man_m2_v1",
                       "acceptability_high_man_m2_v2",
                       "acceptability_high_man_m2_v3",
                       "acceptability_high_man_m2_v4",
                       "acceptability_high_man_m2_v5",
                       "acceptability_high_man_m2_v6",
                       "acceptability_high_man_m3_v1",
                       "acceptability_high_man_m3_v2",
                       "acceptability_high_man_m3_v3",
                       "acceptability_high_man_m3_v4",
                       "acceptability_high_man_m3_v5",
                       "acceptability_high_man_m3_v6",
                       "acceptability_high_man_m4_v1",
                       "acceptability_high_man_m4_v2",
                       "acceptability_high_man_m4_v3",
                       "acceptability_high_man_m4_v4",
                       "acceptability_high_man_m4_v5",
                       "acceptability_high_man_m4_v6",
                       "acceptability_high_man_m5_v1",
                       "acceptability_high_man_m5_v2",
                       "acceptability_high_man_m5_v3",
                       "acceptability_high_man_m5_v4",
                       "acceptability_high_man_m5_v5",
                       "acceptability_high_man_m5_v6",
                       
                       "acceptability_lo_man_m1_v1",
                       "acceptability_lo_man_m1_v2",
                       "acceptability_lo_man_m1_v3",
                       "acceptability_lo_man_m1_v4",
                       "acceptability_lo_man_m1_v5",
                       "acceptability_lo_man_m1_v6",
                       "acceptability_lo_man_m2_v1",
                       "acceptability_lo_man_m2_v2",
                       "acceptability_lo_man_m2_v3",
                       "acceptability_lo_man_m2_v4",
                       "acceptability_lo_man_m2_v5",
                       "acceptability_lo_man_m2_v6",
                       "acceptability_lo_man_m3_v1",
                       "acceptability_lo_man_m3_v2",
                       "acceptability_lo_man_m3_v3",
                       "acceptability_lo_man_m3_v4",
                       "acceptability_lo_man_m3_v5",
                       "acceptability_lo_man_m3_v6",
                       "acceptability_lo_man_m4_v1",
                       "acceptability_lo_man_m4_v2",
                       "acceptability_lo_man_m4_v3",
                       "acceptability_lo_man_m4_v4",
                       "acceptability_lo_man_m4_v5",
                       "acceptability_lo_man_m4_v6",
                       "acceptability_lo_man_m5_v1",
                       "acceptability_lo_man_m5_v2",
                       "acceptability_lo_man_m5_v3",
                       "acceptability_lo_man_m5_v4",
                       "acceptability_lo_man_m5_v5",
                       "acceptability_lo_man_m5_v6",
                       
                       "acceptability_mannequin_m1_v1",
                       "acceptability_mannequin_m1_v2",
                       "acceptability_mannequin_m1_v3",
                       "acceptability_mannequin_m1_v4",
                       "acceptability_mannequin_m1_v5",
                       "acceptability_mannequin_m1_v6",
                       "acceptability_mannequin_m2_v1",
                       "acceptability_mannequin_m2_v2",
                       "acceptability_mannequin_m2_v3",
                       "acceptability_mannequin_m2_v4",
                       "acceptability_mannequin_m2_v5",
                       "acceptability_mannequin_m2_v6",
                       "acceptability_mannequin_m3_v1",
                       "acceptability_mannequin_m3_v2",
                       "acceptability_mannequin_m3_v3",
                       "acceptability_mannequin_m3_v4",
                       "acceptability_mannequin_m3_v5",
                       "acceptability_mannequin_m3_v6",
                       "acceptability_mannequin_m4_v1",
                       "acceptability_mannequin_m4_v2",
                       "acceptability_mannequin_m4_v3",
                       "acceptability_mannequin_m4_v4",
                       "acceptability_mannequin_m4_v5",
                       "acceptability_mannequin_m4_v6",
                       "acceptability_mannequin_m5_v1",
                       "acceptability_mannequin_m5_v2",
                       "acceptability_mannequin_m5_v3",
                       "acceptability_mannequin_m5_v4",
                       "acceptability_mannequin_m5_v5",
                       "acceptability_mannequin_m5_v6",
                       
                       "acceptability_skeleton_m1_v1",
                       "acceptability_skeleton_m1_v2",
                       "acceptability_skeleton_m1_v3",
                       "acceptability_skeleton_m1_v4",
                       "acceptability_skeleton_m1_v5",
                       "acceptability_skeleton_m1_v6",
                       "acceptability_skeleton_m2_v1",
                       "acceptability_skeleton_m2_v2",
                       "acceptability_skeleton_m2_v3",
                       "acceptability_skeleton_m2_v4",
                       "acceptability_skeleton_m2_v5",
                       "acceptability_skeleton_m2_v6",
                       "acceptability_skeleton_m3_v1",
                       "acceptability_skeleton_m3_v2",
                       "acceptability_skeleton_m3_v3",
                       "acceptability_skeleton_m3_v4",
                       "acceptability_skeleton_m3_v5",
                       "acceptability_skeleton_m3_v6",
                       "acceptability_skeleton_m4_v1",
                       "acceptability_skeleton_m4_v2",
                       "acceptability_skeleton_m4_v3",
                       "acceptability_skeleton_m4_v4",
                       "acceptability_skeleton_m4_v5",
                       "acceptability_skeleton_m4_v6",
                       "acceptability_skeleton_m5_v1",
                       "acceptability_skeleton_m5_v2",
                       "acceptability_skeleton_m5_v3",
                       "acceptability_skeleton_m5_v4",
                       "acceptability_skeleton_m5_v5",
                       "acceptability_skeleton_m5_v6",
                       
                       "acceptability_toy_robot_m1_v1",
                       "acceptability_toy_robot_m1_v2",
                       "acceptability_toy_robot_m1_v3",
                       "acceptability_toy_robot_m1_v4",
                       "acceptability_toy_robot_m1_v5",
                       "acceptability_toy_robot_m1_v6",
                       "acceptability_toy_robot_m2_v1",
                       "acceptability_toy_robot_m2_v2",
                       "acceptability_toy_robot_m2_v3",
                       "acceptability_toy_robot_m2_v4",
                       "acceptability_toy_robot_m2_v5",
                       "acceptability_toy_robot_m2_v6",
                       "acceptability_toy_robot_m3_v1",
                       "acceptability_toy_robot_m3_v2",
                       "acceptability_toy_robot_m3_v3",
                       "acceptability_toy_robot_m3_v4",
                       "acceptability_toy_robot_m3_v5",
                       "acceptability_toy_robot_m3_v6",
                       "acceptability_toy_robot_m4_v1",
                       "acceptability_toy_robot_m4_v2",
                       "acceptability_toy_robot_m4_v3",
                       "acceptability_toy_robot_m4_v4",
                       "acceptability_toy_robot_m4_v5",
                       "acceptability_toy_robot_m4_v6",
                       "acceptability_toy_robot_m5_v1",
                       "acceptability_toy_robot_m5_v2",
                       "acceptability_toy_robot_m5_v3",
                       "acceptability_toy_robot_m5_v4",
                       "acceptability_toy_robot_m5_v5",
                       "acceptability_toy_robot_m5_v6",
                       
                       "acceptability_zombie_m1_v1",
                       "acceptability_zombie_m1_v2",
                       "acceptability_zombie_m1_v3",
                       "acceptability_zombie_m1_v4",
                       "acceptability_zombie_m1_v5",
                       "acceptability_zombie_m1_v6",
                       "acceptability_zombie_m2_v1",
                       "acceptability_zombie_m2_v2",
                       "acceptability_zombie_m2_v3",
                       "acceptability_zombie_m2_v4",
                       "acceptability_zombie_m2_v5",
                       "acceptability_zombie_m2_v6",
                       "acceptability_zombie_m3_v1",
                       "acceptability_zombie_m3_v2",
                       "acceptability_zombie_m3_v3",
                       "acceptability_zombie_m3_v4",
                       "acceptability_zombie_m3_v5",
                       "acceptability_zombie_m3_v6",
                       "acceptability_zombie_m4_v1",
                       "acceptability_zombie_m4_v2",
                       "acceptability_zombie_m4_v3",
                       "acceptability_zombie_m4_v4",
                       "acceptability_zombie_m4_v5",
                       "acceptability_zombie_m4_v6",
                       "acceptability_zombie_m5_v1",
                       "acceptability_zombie_m5_v2",
                       "acceptability_zombie_m5_v3",
                       "acceptability_zombie_m5_v4",
                       "acceptability_zombie_m5_v5",
                       "acceptability_zombie_m5_v6",
                       
                       "exploratory_questions")) %>%
    
  # retain only rows with useful information used to score the tasks
  select(subject,
         experiment,
         experiment_condition,
         condition,
         condition_number,
         ratings_type,
         content_type,
         task,
         age,
         gender,
         gender_self_describe,
         acceptability_rating,
         uncanny_valley_check_1,
         uncanny_valley_check_2,
         
         acceptability_battle_robot_m1_v1,
         acceptability_battle_robot_m1_v2,
         acceptability_battle_robot_m1_v3,
         acceptability_battle_robot_m1_v4,
         acceptability_battle_robot_m1_v5,
         acceptability_battle_robot_m1_v6,
         acceptability_battle_robot_m2_v1,
         acceptability_battle_robot_m2_v2,
         acceptability_battle_robot_m2_v3,
         acceptability_battle_robot_m2_v4,
         acceptability_battle_robot_m2_v5,
         acceptability_battle_robot_m2_v6,
         acceptability_battle_robot_m3_v1,
         acceptability_battle_robot_m3_v2,
         acceptability_battle_robot_m3_v3,
         acceptability_battle_robot_m3_v4,
         acceptability_battle_robot_m3_v5,
         acceptability_battle_robot_m3_v6,
         acceptability_battle_robot_m4_v1,
         acceptability_battle_robot_m4_v2,
         acceptability_battle_robot_m4_v3,
         acceptability_battle_robot_m4_v4,
         acceptability_battle_robot_m4_v5,
         acceptability_battle_robot_m4_v6,
         acceptability_battle_robot_m5_v1,
         acceptability_battle_robot_m5_v2,
         acceptability_battle_robot_m5_v3,
         acceptability_battle_robot_m5_v4,
         acceptability_battle_robot_m5_v5,
         acceptability_battle_robot_m5_v6,
         
         acceptability_high_man_m1_v1,
         acceptability_high_man_m1_v2,
         acceptability_high_man_m1_v3,
         acceptability_high_man_m1_v4,
         acceptability_high_man_m1_v5,
         acceptability_high_man_m1_v6,
         acceptability_high_man_m2_v1,
         acceptability_high_man_m2_v2,
         acceptability_high_man_m2_v3,
         acceptability_high_man_m2_v4,
         acceptability_high_man_m2_v5,
         acceptability_high_man_m2_v6,
         acceptability_high_man_m3_v1,
         acceptability_high_man_m3_v2,
         acceptability_high_man_m3_v3,
         acceptability_high_man_m3_v4,
         acceptability_high_man_m3_v5,
         acceptability_high_man_m3_v6,
         acceptability_high_man_m4_v1,
         acceptability_high_man_m4_v2,
         acceptability_high_man_m4_v3,
         acceptability_high_man_m4_v4,
         acceptability_high_man_m4_v5,
         acceptability_high_man_m4_v6,
         acceptability_high_man_m5_v1,
         acceptability_high_man_m5_v2,
         acceptability_high_man_m5_v3,
         acceptability_high_man_m5_v4,
         acceptability_high_man_m5_v5,
         acceptability_high_man_m5_v6,
         
         acceptability_lo_man_m1_v1,
         acceptability_lo_man_m1_v2,
         acceptability_lo_man_m1_v3,
         acceptability_lo_man_m1_v4,
         acceptability_lo_man_m1_v5,
         acceptability_lo_man_m1_v6,
         acceptability_lo_man_m2_v1,
         acceptability_lo_man_m2_v2,
         acceptability_lo_man_m2_v3,
         acceptability_lo_man_m2_v4,
         acceptability_lo_man_m2_v5,
         acceptability_lo_man_m2_v6,
         acceptability_lo_man_m3_v1,
         acceptability_lo_man_m3_v2,
         acceptability_lo_man_m3_v3,
         acceptability_lo_man_m3_v4,
         acceptability_lo_man_m3_v5,
         acceptability_lo_man_m3_v6,
         acceptability_lo_man_m4_v1,
         acceptability_lo_man_m4_v2,
         acceptability_lo_man_m4_v3,
         acceptability_lo_man_m4_v4,
         acceptability_lo_man_m4_v5,
         acceptability_lo_man_m4_v6,
         acceptability_lo_man_m5_v1,
         acceptability_lo_man_m5_v2,
         acceptability_lo_man_m5_v3,
         acceptability_lo_man_m5_v4,
         acceptability_lo_man_m5_v5,
         acceptability_lo_man_m5_v6,
         
         acceptability_mannequin_m1_v1,
         acceptability_mannequin_m1_v2,
         acceptability_mannequin_m1_v3,
         acceptability_mannequin_m1_v4,
         acceptability_mannequin_m1_v5,
         acceptability_mannequin_m1_v6,
         acceptability_mannequin_m2_v1,
         acceptability_mannequin_m2_v2,
         acceptability_mannequin_m2_v3,
         acceptability_mannequin_m2_v4,
         acceptability_mannequin_m2_v5,
         acceptability_mannequin_m2_v6,
         acceptability_mannequin_m3_v1,
         acceptability_mannequin_m3_v2,
         acceptability_mannequin_m3_v3,
         acceptability_mannequin_m3_v4,
         acceptability_mannequin_m3_v5,
         acceptability_mannequin_m3_v6,
         acceptability_mannequin_m4_v1,
         acceptability_mannequin_m4_v2,
         acceptability_mannequin_m4_v3,
         acceptability_mannequin_m4_v4,
         acceptability_mannequin_m4_v5,
         acceptability_mannequin_m4_v6,
         acceptability_mannequin_m5_v1,
         acceptability_mannequin_m5_v2,
         acceptability_mannequin_m5_v3,
         acceptability_mannequin_m5_v4,
         acceptability_mannequin_m5_v5,
         acceptability_mannequin_m5_v6,
         
         acceptability_skeleton_m1_v1,
         acceptability_skeleton_m1_v2,
         acceptability_skeleton_m1_v3,
         acceptability_skeleton_m1_v4,
         acceptability_skeleton_m1_v5,
         acceptability_skeleton_m1_v6,
         acceptability_skeleton_m2_v1,
         acceptability_skeleton_m2_v2,
         acceptability_skeleton_m2_v3,
         acceptability_skeleton_m2_v4,
         acceptability_skeleton_m2_v5,
         acceptability_skeleton_m2_v6,
         acceptability_skeleton_m3_v1,
         acceptability_skeleton_m3_v2,
         acceptability_skeleton_m3_v3,
         acceptability_skeleton_m3_v4,
         acceptability_skeleton_m3_v5,
         acceptability_skeleton_m3_v6,
         acceptability_skeleton_m4_v1,
         acceptability_skeleton_m4_v2,
         acceptability_skeleton_m4_v3,
         acceptability_skeleton_m4_v4,
         acceptability_skeleton_m4_v5,
         acceptability_skeleton_m4_v6,
         acceptability_skeleton_m5_v1,
         acceptability_skeleton_m5_v2,
         acceptability_skeleton_m5_v3,
         acceptability_skeleton_m5_v4,
         acceptability_skeleton_m5_v5,
         acceptability_skeleton_m5_v6,
         
         acceptability_toy_robot_m1_v1,
         acceptability_toy_robot_m1_v2,
         acceptability_toy_robot_m1_v3,
         acceptability_toy_robot_m1_v4,
         acceptability_toy_robot_m1_v5,
         acceptability_toy_robot_m1_v6,
         acceptability_toy_robot_m2_v1,
         acceptability_toy_robot_m2_v2,
         acceptability_toy_robot_m2_v3,
         acceptability_toy_robot_m2_v4,
         acceptability_toy_robot_m2_v5,
         acceptability_toy_robot_m2_v6,
         acceptability_toy_robot_m3_v1,
         acceptability_toy_robot_m3_v2,
         acceptability_toy_robot_m3_v3,
         acceptability_toy_robot_m3_v4,
         acceptability_toy_robot_m3_v5,
         acceptability_toy_robot_m3_v6,
         acceptability_toy_robot_m4_v1,
         acceptability_toy_robot_m4_v2,
         acceptability_toy_robot_m4_v3,
         acceptability_toy_robot_m4_v4,
         acceptability_toy_robot_m4_v5,
         acceptability_toy_robot_m4_v6,
         acceptability_toy_robot_m5_v1,
         acceptability_toy_robot_m5_v2,
         acceptability_toy_robot_m5_v3,
         acceptability_toy_robot_m5_v4,
         acceptability_toy_robot_m5_v5,
         acceptability_toy_robot_m5_v6,
         
         acceptability_zombie_m1_v1,
         acceptability_zombie_m1_v2,
         acceptability_zombie_m1_v3,
         acceptability_zombie_m1_v4,
         acceptability_zombie_m1_v5,
         acceptability_zombie_m1_v6,
         acceptability_zombie_m2_v1,
         acceptability_zombie_m2_v2,
         acceptability_zombie_m2_v3,
         acceptability_zombie_m2_v4,
         acceptability_zombie_m2_v5,
         acceptability_zombie_m2_v6,
         acceptability_zombie_m3_v1,
         acceptability_zombie_m3_v2,
         acceptability_zombie_m3_v3,
         acceptability_zombie_m3_v4,
         acceptability_zombie_m3_v5,
         acceptability_zombie_m3_v6,
         acceptability_zombie_m4_v1,
         acceptability_zombie_m4_v2,
         acceptability_zombie_m4_v3,
         acceptability_zombie_m4_v4,
         acceptability_zombie_m4_v5,
         acceptability_zombie_m4_v6,
         acceptability_zombie_m5_v1,
         acceptability_zombie_m5_v2,
         acceptability_zombie_m5_v3,
         acceptability_zombie_m5_v4,
         acceptability_zombie_m5_v5,
         acceptability_zombie_m5_v6) %>%
   
   # guess appropriate data types
  type_convert()  

```




## Write to disk

data_trial_level.csv contains participant level data in tidy format.

```{r}

write_rds(data_trial_level_acceptability_condition, "processed/2.1_data_trial_level_acceptability_condition.rds", compress = "gz")
write_rds(data_trial_level_likeness_condition, "processed/2.1_data_trial_level_likeness_condition.rds", compress = "gz")

```

# Participant-level data

## Study conditions, demographics and method variables

```{r}

# select out those variables needed for likeness demographics

data_conditions_and_demographics_likeness <- data_trial_level_likeness_condition %>% 
  select(subject, 
         experiment, 
         experiment_condition,
         condition,
         condition_number,
         ratings_type,
         content_type,
         age, 
         gender,
         gender_self_describe) %>%
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup() 

# select out those variables needed for acceptability demographics

data_conditions_and_demographics_acceptability <- data_trial_level_acceptability_condition %>% 
  select(subject, 
         experiment, 
         experiment_condition,
         condition,
         condition_number,
         ratings_type,
         content_type,
         age, 
         gender,
         gender_self_describe) %>%
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup() 

data_conditions_and_demographics <- data_conditions_and_demographics_likeness %>%
  bind_rows(data_conditions_and_demographics_acceptability)

rm(data_conditions_and_demographics_likeness, data_conditions_and_demographics_acceptability)
```

## Likeness Ratings 

```{r}

# Subset the data for the likeness condition ratings

data_trial_level_likeness_condition_ratings <- data_trial_level_likeness_condition %>%
      filter(task %in% c("acceptability_battle_robot",
                       "acceptability_high_man",
                       "acceptability_lo_man",
                       "acceptability_mannequin",
                       "acceptability_skeleton",
                       "acceptability_toy_robot",
                       "acceptability_zombie", 
                       "likeness_battle_robot",
                       "likeness_high_man",
                       "likeness_lo_man",
                       "likeness_mannequin",
                       "likeness_skeleton",
                       "likeness_toy_robot",
                       "likeness_zombie")) %>%
  
    select(subject, 
         task,
        acceptability_rating,
        likeness_rating) %>%
  arrange(subject, task) 
  
# Spread data so that there is only one row per participant

data_trial_level_likeness_condition_long <- data_trial_level_likeness_condition_ratings %>%
  pivot_wider(names_from = task, values_from = c(acceptability_rating, likeness_rating)) %>% 
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup() %>%
  mutate(acceptability_battle_robot = acceptability_rating_acceptability_battle_robot,
         acceptability_high_man = acceptability_rating_acceptability_high_man,
         acceptability_lo_man = acceptability_rating_acceptability_lo_man,
         acceptability_mannequin = acceptability_rating_acceptability_mannequin,
         acceptability_skeleton = acceptability_rating_acceptability_skeleton, 
         acceptability_toy_robot = acceptability_rating_acceptability_toy_robot,
         acceptability_zombie = acceptability_rating_acceptability_zombie, 
         likeness_battle_robot = likeness_rating_likeness_battle_robot, 
         likeness_high_man = likeness_rating_likeness_high_man,
         likeness_lo_man = likeness_rating_likeness_lo_man, 
         likeness_mannequin = likeness_rating_likeness_mannequin,
         likeness_skeleton = likeness_rating_likeness_skeleton, 
         likeness_toy_robot = likeness_rating_likeness_toy_robot,
         likeness_zombie = likeness_rating_likeness_zombie) %>%
  
  select(subject,
         acceptability_battle_robot,
         acceptability_high_man,
         acceptability_lo_man,
         acceptability_mannequin,
         acceptability_skeleton,
         acceptability_toy_robot,
         acceptability_zombie,
         likeness_battle_robot,
         likeness_high_man,
         likeness_lo_man,
         likeness_mannequin,
         likeness_skeleton,
         likeness_toy_robot,
         likeness_zombie)

rm(data_trial_level_likeness_condition_ratings)

```


## Acceptance Ratings 

```{r}

# Subset the data for the acceptability condition ratings

data_trial_level_acceptability_condition_ratings <- data_trial_level_acceptability_condition %>%
      filter(task %in% c("acceptability_battle_robot_static_b1",
                       "acceptability_high_man_static_b1",
                       "acceptability_lo_man_static_b1",
                       "acceptability_mannequin_static_b1",
                       "acceptability_skeleton_static_b1",
                       "acceptability_toy_robot_static_b1",
                       "acceptability_zombie_static_b1",
                       "acceptability_battle_robot_static_b2",
                       "acceptability_high_man_static_b2",
                       "acceptability_lo_man_static_b2",
                       "acceptability_mannequin_static_b2",
                       "acceptability_skeleton_static_b2",
                       "acceptability_toy_robot_static_b2",
                       "acceptability_zombie_static_b2",
                       "acceptability_battle_robot_static_b3",
                       "acceptability_high_man_static_b3",
                       "acceptability_lo_man_static_b3",
                       "acceptability_mannequin_static_b3",
                       "acceptability_skeleton_static_b3",
                       "acceptability_toy_robot_static_b3",
                       "acceptability_zombie_static_b3",
                       
                       "acceptability_battle_robot_m1_v1",
                       "acceptability_battle_robot_m1_v2",
                       "acceptability_battle_robot_m1_v3",
                       "acceptability_battle_robot_m1_v4",
                       "acceptability_battle_robot_m1_v5",
                       "acceptability_battle_robot_m1_v6",
                       "acceptability_battle_robot_m2_v1",
                       "acceptability_battle_robot_m2_v2",
                       "acceptability_battle_robot_m2_v3",
                       "acceptability_battle_robot_m2_v4",
                       "acceptability_battle_robot_m2_v5",
                       "acceptability_battle_robot_m2_v6",
                       "acceptability_battle_robot_m3_v1",
                       "acceptability_battle_robot_m3_v2",
                       "acceptability_battle_robot_m3_v3",
                       "acceptability_battle_robot_m3_v4",
                       "acceptability_battle_robot_m3_v5",
                       "acceptability_battle_robot_m3_v6",
                       "acceptability_battle_robot_m4_v1",
                       "acceptability_battle_robot_m4_v2",
                       "acceptability_battle_robot_m4_v3",
                       "acceptability_battle_robot_m4_v4",
                       "acceptability_battle_robot_m4_v5",
                       "acceptability_battle_robot_m4_v6",
                       "acceptability_battle_robot_m5_v1",
                       "acceptability_battle_robot_m5_v2",
                       "acceptability_battle_robot_m5_v3",
                       "acceptability_battle_robot_m5_v4",
                       "acceptability_battle_robot_m5_v5",
                       "acceptability_battle_robot_m5_v6",
                       
                       "acceptability_high_man_m1_v1",
                       "acceptability_high_man_m1_v2",
                       "acceptability_high_man_m1_v3",
                       "acceptability_high_man_m1_v4",
                       "acceptability_high_man_m1_v5",
                       "acceptability_high_man_m1_v6",
                       "acceptability_high_man_m2_v1",
                       "acceptability_high_man_m2_v2",
                       "acceptability_high_man_m2_v3",
                       "acceptability_high_man_m2_v4",
                       "acceptability_high_man_m2_v5",
                       "acceptability_high_man_m2_v6",
                       "acceptability_high_man_m3_v1",
                       "acceptability_high_man_m3_v2",
                       "acceptability_high_man_m3_v3",
                       "acceptability_high_man_m3_v4",
                       "acceptability_high_man_m3_v5",
                       "acceptability_high_man_m3_v6",
                       "acceptability_high_man_m4_v1",
                       "acceptability_high_man_m4_v2",
                       "acceptability_high_man_m4_v3",
                       "acceptability_high_man_m4_v4",
                       "acceptability_high_man_m4_v5",
                       "acceptability_high_man_m4_v6",
                       "acceptability_high_man_m5_v1",
                       "acceptability_high_man_m5_v2",
                       "acceptability_high_man_m5_v3",
                       "acceptability_high_man_m5_v4",
                       "acceptability_high_man_m5_v5",
                       "acceptability_high_man_m5_v6",
                       
                       "acceptability_lo_man_m1_v1",
                       "acceptability_lo_man_m1_v2",
                       "acceptability_lo_man_m1_v3",
                       "acceptability_lo_man_m1_v4",
                       "acceptability_lo_man_m1_v5",
                       "acceptability_lo_man_m1_v6",
                       "acceptability_lo_man_m2_v1",
                       "acceptability_lo_man_m2_v2",
                       "acceptability_lo_man_m2_v3",
                       "acceptability_lo_man_m2_v4",
                       "acceptability_lo_man_m2_v5",
                       "acceptability_lo_man_m2_v6",
                       "acceptability_lo_man_m3_v1",
                       "acceptability_lo_man_m3_v2",
                       "acceptability_lo_man_m3_v3",
                       "acceptability_lo_man_m3_v4",
                       "acceptability_lo_man_m3_v5",
                       "acceptability_lo_man_m3_v6",
                       "acceptability_lo_man_m4_v1",
                       "acceptability_lo_man_m4_v2",
                       "acceptability_lo_man_m4_v3",
                       "acceptability_lo_man_m4_v4",
                       "acceptability_lo_man_m4_v5",
                       "acceptability_lo_man_m4_v6",
                       "acceptability_lo_man_m5_v1",
                       "acceptability_lo_man_m5_v2",
                       "acceptability_lo_man_m5_v3",
                       "acceptability_lo_man_m5_v4",
                       "acceptability_lo_man_m5_v5",
                       "acceptability_lo_man_m5_v6",
                       
                       "acceptability_mannequin_m1_v1",
                       "acceptability_mannequin_m1_v2",
                       "acceptability_mannequin_m1_v3",
                       "acceptability_mannequin_m1_v4",
                       "acceptability_mannequin_m1_v5",
                       "acceptability_mannequin_m1_v6",
                       "acceptability_mannequin_m2_v1",
                       "acceptability_mannequin_m2_v2",
                       "acceptability_mannequin_m2_v3",
                       "acceptability_mannequin_m2_v4",
                       "acceptability_mannequin_m2_v5",
                       "acceptability_mannequin_m2_v6",
                       "acceptability_mannequin_m3_v1",
                       "acceptability_mannequin_m3_v2",
                       "acceptability_mannequin_m3_v3",
                       "acceptability_mannequin_m3_v4",
                       "acceptability_mannequin_m3_v5",
                       "acceptability_mannequin_m3_v6",
                       "acceptability_mannequin_m4_v1",
                       "acceptability_mannequin_m4_v2",
                       "acceptability_mannequin_m4_v3",
                       "acceptability_mannequin_m4_v4",
                       "acceptability_mannequin_m4_v5",
                       "acceptability_mannequin_m4_v6",
                       "acceptability_mannequin_m5_v1",
                       "acceptability_mannequin_m5_v2",
                       "acceptability_mannequin_m5_v3",
                       "acceptability_mannequin_m5_v4",
                       "acceptability_mannequin_m5_v5",
                       "acceptability_mannequin_m5_v6",
                       
                       "acceptability_skeleton_m1_v1",
                       "acceptability_skeleton_m1_v2",
                       "acceptability_skeleton_m1_v3",
                       "acceptability_skeleton_m1_v4",
                       "acceptability_skeleton_m1_v5",
                       "acceptability_skeleton_m1_v6",
                       "acceptability_skeleton_m2_v1",
                       "acceptability_skeleton_m2_v2",
                       "acceptability_skeleton_m2_v3",
                       "acceptability_skeleton_m2_v4",
                       "acceptability_skeleton_m2_v5",
                       "acceptability_skeleton_m2_v6",
                       "acceptability_skeleton_m3_v1",
                       "acceptability_skeleton_m3_v2",
                       "acceptability_skeleton_m3_v3",
                       "acceptability_skeleton_m3_v4",
                       "acceptability_skeleton_m3_v5",
                       "acceptability_skeleton_m3_v6",
                       "acceptability_skeleton_m4_v1",
                       "acceptability_skeleton_m4_v2",
                       "acceptability_skeleton_m4_v3",
                       "acceptability_skeleton_m4_v4",
                       "acceptability_skeleton_m4_v5",
                       "acceptability_skeleton_m4_v6",
                       "acceptability_skeleton_m5_v1",
                       "acceptability_skeleton_m5_v2",
                       "acceptability_skeleton_m5_v3",
                       "acceptability_skeleton_m5_v4",
                       "acceptability_skeleton_m5_v5",
                       "acceptability_skeleton_m5_v6",
                       
                       "acceptability_toy_robot_m1_v1",
                       "acceptability_toy_robot_m1_v2",
                       "acceptability_toy_robot_m1_v3",
                       "acceptability_toy_robot_m1_v4",
                       "acceptability_toy_robot_m1_v5",
                       "acceptability_toy_robot_m1_v6",
                       "acceptability_toy_robot_m2_v1",
                       "acceptability_toy_robot_m2_v2",
                       "acceptability_toy_robot_m2_v3",
                       "acceptability_toy_robot_m2_v4",
                       "acceptability_toy_robot_m2_v5",
                       "acceptability_toy_robot_m2_v6",
                       "acceptability_toy_robot_m3_v1",
                       "acceptability_toy_robot_m3_v2",
                       "acceptability_toy_robot_m3_v3",
                       "acceptability_toy_robot_m3_v4",
                       "acceptability_toy_robot_m3_v5",
                       "acceptability_toy_robot_m3_v6",
                       "acceptability_toy_robot_m4_v1",
                       "acceptability_toy_robot_m4_v2",
                       "acceptability_toy_robot_m4_v3",
                       "acceptability_toy_robot_m4_v4",
                       "acceptability_toy_robot_m4_v5",
                       "acceptability_toy_robot_m4_v6",
                       "acceptability_toy_robot_m5_v1",
                       "acceptability_toy_robot_m5_v2",
                       "acceptability_toy_robot_m5_v3",
                       "acceptability_toy_robot_m5_v4",
                       "acceptability_toy_robot_m5_v5",
                       "acceptability_toy_robot_m5_v6",
                       
                       "acceptability_zombie_m1_v1",
                       "acceptability_zombie_m1_v2",
                       "acceptability_zombie_m1_v3",
                       "acceptability_zombie_m1_v4",
                       "acceptability_zombie_m1_v5",
                       "acceptability_zombie_m1_v6",
                       "acceptability_zombie_m2_v1",
                       "acceptability_zombie_m2_v2",
                       "acceptability_zombie_m2_v3",
                       "acceptability_zombie_m2_v4",
                       "acceptability_zombie_m2_v5",
                       "acceptability_zombie_m2_v6",
                       "acceptability_zombie_m3_v1",
                       "acceptability_zombie_m3_v2",
                       "acceptability_zombie_m3_v3",
                       "acceptability_zombie_m3_v4",
                       "acceptability_zombie_m3_v5",
                       "acceptability_zombie_m3_v6",
                       "acceptability_zombie_m4_v1",
                       "acceptability_zombie_m4_v2",
                       "acceptability_zombie_m4_v3",
                       "acceptability_zombie_m4_v4",
                       "acceptability_zombie_m4_v5",
                       "acceptability_zombie_m4_v6",
                       "acceptability_zombie_m5_v1",
                       "acceptability_zombie_m5_v2",
                       "acceptability_zombie_m5_v3",
                       "acceptability_zombie_m5_v4",
                       "acceptability_zombie_m5_v5",
                       "acceptability_zombie_m5_v6")) %>%
  
    select(subject, 
         task,
        acceptability_rating,
        
         acceptability_battle_robot_m1_v1,
         acceptability_battle_robot_m1_v2,
         acceptability_battle_robot_m1_v3,
         acceptability_battle_robot_m1_v4,
         acceptability_battle_robot_m1_v5,
         acceptability_battle_robot_m1_v6,
         acceptability_battle_robot_m2_v1,
         acceptability_battle_robot_m2_v2,
         acceptability_battle_robot_m2_v3,
         acceptability_battle_robot_m2_v4,
         acceptability_battle_robot_m2_v5,
         acceptability_battle_robot_m2_v6,
         acceptability_battle_robot_m3_v1,
         acceptability_battle_robot_m3_v2,
         acceptability_battle_robot_m3_v3,
         acceptability_battle_robot_m3_v4,
         acceptability_battle_robot_m3_v5,
         acceptability_battle_robot_m3_v6,
         acceptability_battle_robot_m4_v1,
         acceptability_battle_robot_m4_v2,
         acceptability_battle_robot_m4_v3,
         acceptability_battle_robot_m4_v4,
         acceptability_battle_robot_m4_v5,
         acceptability_battle_robot_m4_v6,
         acceptability_battle_robot_m5_v1,
         acceptability_battle_robot_m5_v2,
         acceptability_battle_robot_m5_v3,
         acceptability_battle_robot_m5_v4,
         acceptability_battle_robot_m5_v5,
         acceptability_battle_robot_m5_v6,
         
         acceptability_high_man_m1_v1,
         acceptability_high_man_m1_v2,
         acceptability_high_man_m1_v3,
         acceptability_high_man_m1_v4,
         acceptability_high_man_m1_v5,
         acceptability_high_man_m1_v6,
         acceptability_high_man_m2_v1,
         acceptability_high_man_m2_v2,
         acceptability_high_man_m2_v3,
         acceptability_high_man_m2_v4,
         acceptability_high_man_m2_v5,
         acceptability_high_man_m2_v6,
         acceptability_high_man_m3_v1,
         acceptability_high_man_m3_v2,
         acceptability_high_man_m3_v3,
         acceptability_high_man_m3_v4,
         acceptability_high_man_m3_v5,
         acceptability_high_man_m3_v6,
         acceptability_high_man_m4_v1,
         acceptability_high_man_m4_v2,
         acceptability_high_man_m4_v3,
         acceptability_high_man_m4_v4,
         acceptability_high_man_m4_v5,
         acceptability_high_man_m4_v6,
         acceptability_high_man_m5_v1,
         acceptability_high_man_m5_v2,
         acceptability_high_man_m5_v3,
         acceptability_high_man_m5_v4,
         acceptability_high_man_m5_v5,
         acceptability_high_man_m5_v6,
         
         acceptability_lo_man_m1_v1,
         acceptability_lo_man_m1_v2,
         acceptability_lo_man_m1_v3,
         acceptability_lo_man_m1_v4,
         acceptability_lo_man_m1_v5,
         acceptability_lo_man_m1_v6,
         acceptability_lo_man_m2_v1,
         acceptability_lo_man_m2_v2,
         acceptability_lo_man_m2_v3,
         acceptability_lo_man_m2_v4,
         acceptability_lo_man_m2_v5,
         acceptability_lo_man_m2_v6,
         acceptability_lo_man_m3_v1,
         acceptability_lo_man_m3_v2,
         acceptability_lo_man_m3_v3,
         acceptability_lo_man_m3_v4,
         acceptability_lo_man_m3_v5,
         acceptability_lo_man_m3_v6,
         acceptability_lo_man_m4_v1,
         acceptability_lo_man_m4_v2,
         acceptability_lo_man_m4_v3,
         acceptability_lo_man_m4_v4,
         acceptability_lo_man_m4_v5,
         acceptability_lo_man_m4_v6,
         acceptability_lo_man_m5_v1,
         acceptability_lo_man_m5_v2,
         acceptability_lo_man_m5_v3,
         acceptability_lo_man_m5_v4,
         acceptability_lo_man_m5_v5,
         acceptability_lo_man_m5_v6,
         
         acceptability_mannequin_m1_v1,
         acceptability_mannequin_m1_v2,
         acceptability_mannequin_m1_v3,
         acceptability_mannequin_m1_v4,
         acceptability_mannequin_m1_v5,
         acceptability_mannequin_m1_v6,
         acceptability_mannequin_m2_v1,
         acceptability_mannequin_m2_v2,
         acceptability_mannequin_m2_v3,
         acceptability_mannequin_m2_v4,
         acceptability_mannequin_m2_v5,
         acceptability_mannequin_m2_v6,
         acceptability_mannequin_m3_v1,
         acceptability_mannequin_m3_v2,
         acceptability_mannequin_m3_v3,
         acceptability_mannequin_m3_v4,
         acceptability_mannequin_m3_v5,
         acceptability_mannequin_m3_v6,
         acceptability_mannequin_m4_v1,
         acceptability_mannequin_m4_v2,
         acceptability_mannequin_m4_v3,
         acceptability_mannequin_m4_v4,
         acceptability_mannequin_m4_v5,
         acceptability_mannequin_m4_v6,
         acceptability_mannequin_m5_v1,
         acceptability_mannequin_m5_v2,
         acceptability_mannequin_m5_v3,
         acceptability_mannequin_m5_v4,
         acceptability_mannequin_m5_v5,
         acceptability_mannequin_m5_v6,
         
         acceptability_skeleton_m1_v1,
         acceptability_skeleton_m1_v2,
         acceptability_skeleton_m1_v3,
         acceptability_skeleton_m1_v4,
         acceptability_skeleton_m1_v5,
         acceptability_skeleton_m1_v6,
         acceptability_skeleton_m2_v1,
         acceptability_skeleton_m2_v2,
         acceptability_skeleton_m2_v3,
         acceptability_skeleton_m2_v4,
         acceptability_skeleton_m2_v5,
         acceptability_skeleton_m2_v6,
         acceptability_skeleton_m3_v1,
         acceptability_skeleton_m3_v2,
         acceptability_skeleton_m3_v3,
         acceptability_skeleton_m3_v4,
         acceptability_skeleton_m3_v5,
         acceptability_skeleton_m3_v6,
         acceptability_skeleton_m4_v1,
         acceptability_skeleton_m4_v2,
         acceptability_skeleton_m4_v3,
         acceptability_skeleton_m4_v4,
         acceptability_skeleton_m4_v5,
         acceptability_skeleton_m4_v6,
         acceptability_skeleton_m5_v1,
         acceptability_skeleton_m5_v2,
         acceptability_skeleton_m5_v3,
         acceptability_skeleton_m5_v4,
         acceptability_skeleton_m5_v5,
         acceptability_skeleton_m5_v6,
         
         acceptability_toy_robot_m1_v1,
         acceptability_toy_robot_m1_v2,
         acceptability_toy_robot_m1_v3,
         acceptability_toy_robot_m1_v4,
         acceptability_toy_robot_m1_v5,
         acceptability_toy_robot_m1_v6,
         acceptability_toy_robot_m2_v1,
         acceptability_toy_robot_m2_v2,
         acceptability_toy_robot_m2_v3,
         acceptability_toy_robot_m2_v4,
         acceptability_toy_robot_m2_v5,
         acceptability_toy_robot_m2_v6,
         acceptability_toy_robot_m3_v1,
         acceptability_toy_robot_m3_v2,
         acceptability_toy_robot_m3_v3,
         acceptability_toy_robot_m3_v4,
         acceptability_toy_robot_m3_v5,
         acceptability_toy_robot_m3_v6,
         acceptability_toy_robot_m4_v1,
         acceptability_toy_robot_m4_v2,
         acceptability_toy_robot_m4_v3,
         acceptability_toy_robot_m4_v4,
         acceptability_toy_robot_m4_v5,
         acceptability_toy_robot_m4_v6,
         acceptability_toy_robot_m5_v1,
         acceptability_toy_robot_m5_v2,
         acceptability_toy_robot_m5_v3,
         acceptability_toy_robot_m5_v4,
         acceptability_toy_robot_m5_v5,
         acceptability_toy_robot_m5_v6,
         
         acceptability_zombie_m1_v1,
         acceptability_zombie_m1_v2,
         acceptability_zombie_m1_v3,
         acceptability_zombie_m1_v4,
         acceptability_zombie_m1_v5,
         acceptability_zombie_m1_v6,
         acceptability_zombie_m2_v1,
         acceptability_zombie_m2_v2,
         acceptability_zombie_m2_v3,
         acceptability_zombie_m2_v4,
         acceptability_zombie_m2_v5,
         acceptability_zombie_m2_v6,
         acceptability_zombie_m3_v1,
         acceptability_zombie_m3_v2,
         acceptability_zombie_m3_v3,
         acceptability_zombie_m3_v4,
         acceptability_zombie_m3_v5,
         acceptability_zombie_m3_v6,
         acceptability_zombie_m4_v1,
         acceptability_zombie_m4_v2,
         acceptability_zombie_m4_v3,
         acceptability_zombie_m4_v4,
         acceptability_zombie_m4_v5,
         acceptability_zombie_m4_v6,
         acceptability_zombie_m5_v1,
         acceptability_zombie_m5_v2,
         acceptability_zombie_m5_v3,
         acceptability_zombie_m5_v4,
         acceptability_zombie_m5_v5,
         acceptability_zombie_m5_v6) %>%
  arrange(subject, task) 
  
data_trial_level_acceptability_moving_ratings_long <- data_trial_level_acceptability_condition_ratings %>% 
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup() %>%
  select(-task,
         -acceptability_rating)

data_trial_level_acceptability_static_ratings_long <- data_trial_level_acceptability_condition_ratings %>% 
  select(subject,
         task,
         acceptability_rating) %>%
  filter(task %in% c("acceptability_battle_robot_static_b1",
                     "acceptability_high_man_static_b1",
                     "acceptability_lo_man_static_b1",
                     "acceptability_mannequin_static_b1",
                     "acceptability_skeleton_static_b1",
                     "acceptability_toy_robot_static_b1",
                     "acceptability_zombie_static_b1",
                     "acceptability_battle_robot_static_b2",
                     "acceptability_high_man_static_b2",
                     "acceptability_lo_man_static_b2",
                     "acceptability_mannequin_static_b2",
                     "acceptability_skeleton_static_b2",
                     "acceptability_toy_robot_static_b2",
                     "acceptability_zombie_static_b2",
                     "acceptability_battle_robot_static_b3",
                     "acceptability_high_man_static_b3",
                     "acceptability_lo_man_static_b3",
                     "acceptability_mannequin_static_b3",
                     "acceptability_skeleton_static_b3",
                     "acceptability_toy_robot_static_b3",
                     "acceptability_zombie_static_b3")) %>%

# Spread data so that there is only one row per participant

  pivot_wider(names_from = task, values_from = c(acceptability_rating))


data_trial_level_acceptability_condition_long <- data_trial_level_acceptability_static_ratings_long %>%
  bind_rows(data_trial_level_acceptability_moving_ratings_long) %>%
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup()

rm(data_trial_level_acceptability_condition_ratings, data_trial_level_acceptability_static_ratings_long, data_trial_level_acceptability_moving_ratings_long)
```


# Exploratory Questions

```{r}

# Select and retain only the exploratory questions and participant id from the likeness condition

data_exploratory_questions_likeness_condition <- data_trial_level_likeness_condition %>%
  select(subject, 
         uncanny_valley_check_1, 
         uncanny_valley_check_2) %>% 
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup() 
  
# Select and retain only the exploratory questions and participant id from the acceptability condition
data_exploratory_questions_acceptability_condition <- data_trial_level_acceptability_condition %>%
  select(subject, 
         uncanny_valley_check_1, 
         uncanny_valley_check_2) %>% 
  group_by(subject) %>%
  summarise_all(~ first(na.omit(.))) %>%
  ungroup()

# Combine the two
data_exploratory_questions <- data_exploratory_questions_likeness_condition %>%
  bind_rows(data_exploratory_questions_acceptability_condition)

rm(data_exploratory_questions_likeness_condition, data_exploratory_questions_acceptability_condition)

```


# Join Files Together

```{r}

# Join all the files together for analyses

data_post_processing_acceptability_condition <- data_conditions_and_demographics %>% 
  inner_join(data_trial_level_acceptability_condition_long, by='subject') %>%
  inner_join(data_exploratory_questions, by='subject')

data_post_processing_likeness_condition <- data_conditions_and_demographics %>% 
  inner_join(data_trial_level_likeness_condition_long, by='subject')  %>%
  inner_join(data_exploratory_questions, by='subject')


```

## Write to disk

```{r}

# full data file
write_csv(data_post_processing_acceptability_condition, "processed/2.2_data_acceptability_condition_post_processing.csv")

write_csv(data_post_processing_likeness_condition, "processed/2.2_data_likeness_condition_post_processing.csv")

```



